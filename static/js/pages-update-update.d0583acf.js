(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-update-update"],{1078:function(t,e,i){"use strict";i("7a82"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("a9e3"),i("e25e");var n=i("e2d5"),a={name:"uniDateformat",props:{date:{type:[Object,String,Number],default:function(){return"-"}},locale:{type:String,default:"zh"},threshold:{type:Array,default:function(){return[0,0]}},format:{type:String,default:"yyyy/MM/dd hh:mm:ss"},refreshRate:{type:[Number,String],default:0}},data:function(){return{refreshMark:0}},computed:{dateShow:function(){return this.refreshMark,(0,n.friendlyDate)(this.date,{locale:this.locale,threshold:this.threshold,format:this.format})}},watch:{refreshRate:{handler:function(){this.setAutoRefresh()},immediate:!0}},methods:{refresh:function(){this.refreshMark++},setAutoRefresh:function(){var t=this;clearInterval(this.refreshInterval),this.refreshRate&&(this.refreshInterval=setInterval((function(){t.refresh()}),parseInt(this.refreshRate)))}}};e.default=a},"3ea9":function(t,e,i){var n=i("6331");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var a=i("4f06").default;a("48b51b78",n,!0,{sourceMap:!1,shadowMode:!1})},"453e":function(t,e,i){"use strict";i.r(e);var n=i("5583"),a=i("bcc0");for(var o in a)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(o);var r=i("f0c5"),s=Object(r["a"])(a["default"],n["b"],n["c"],!1,null,"690ab064",null,!1,n["a"],void 0);e["default"]=s.exports},5583:function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"c",(function(){return a})),i.d(e,"a",(function(){}));var n=function(){var t=this.$createElement,e=this._self._c||t;return e("v-uni-text",[this._v(this._s(this.dateShow))])},a=[]},6331:function(t,e,i){var n=i("24fb");e=n(!1),e.push([t.i,'@charset "UTF-8";\r\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\r\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\r\n/* 颜色变量 */\r\n/* 行为相关颜色 */\r\n/* 文字基本颜色 */\r\n/* 背景颜色 */\r\n/* 边框颜色 */\r\n/* 尺寸变量 */\r\n/* 文字尺寸 */\r\n/* 图片尺寸 */\r\n/* Border Radius */\r\n/* 水平间距 */\r\n/* 垂直间距 */\r\n/* 透明度 */\r\n/* 文章场景相关 */[data-v-3278e702] .ql-blank::before{font-style:normal;color:#e0e0e0}.edit[data-v-3278e702]{padding:0 %?30?%;box-sizing:border-box;display:flex;flex-direction:column;min-height:calc(100vh - %?88?%)}.edit .title[data-v-3278e702]{margin-bottom:%?30?%}.edit .title uni-input[data-v-3278e702]{height:%?120?%;font-size:%?46?%;border-bottom:1px solid #e4e4e4;color:#333}.edit .title .placeholder-class[data-v-3278e702]{color:#e0e0e0}.edit .userinfo[data-v-3278e702]{display:flex;align-items:center;height:%?80?%;margin:%?20?% 0}.edit .userinfo .left[data-v-3278e702]{margin-right:%?10?%}.edit .userinfo .left uni-image[data-v-3278e702]{width:%?60?%;height:%?60?%;border-radius:50%}.edit .userinfo .right .meta[data-v-3278e702]{font-size:%?24?%;color:#ccc}.edit .userinfo .right .meta .publish-time[data-v-3278e702]{margin-right:%?6?%}.edit .content[data-v-3278e702]{flex:1}.edit .content #editor[data-v-3278e702]{height:100%;margin-bottom:%?20?%}.edit .button-box[data-v-3278e702]{height:%?80?%;margin-bottom:%?130?%}.edit .tools[data-v-3278e702]{display:flex;justify-content:space-around;width:100%;height:%?100?%;position:fixed;bottom:0;left:%?0?%;background-color:#fff}.edit .tools .tool[data-v-3278e702]{height:100%;line-height:%?100?%}.edit .tools .tool .iconfont[data-v-3278e702]{font-size:%?36?%;color:#333}.edit .tools .tool.active .iconfont[data-v-3278e702]{color:#0099f8}',""]),t.exports=e},9202:function(t,e,i){"use strict";(function(t){i("7a82");var n=i("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=n(i("5530")),o=n(i("c7eb")),r=n(i("1da1"));i("ac1f"),i("d81d"),i("fb6a");var s=i("cd5d"),l=t.database(),c={data:function(){return{arcID:"",article:{title:"",content:"",desc:"",pic_urls:[],province:"",user_id:[{avatar_file:{}}]},toolsShow:!1,headClassToggle:!1,boldClassToggle:!1,italicClassToggle:!1}},onLoad:function(t){var e=this;(0,s.getIp)().then((function(t){e.article.province=t.province})),this.arcID=t.id,this.getArtDetail(t.id)},methods:{getArtDetail:function(t){var e=this,i=l.collection("quanzi-article").where("_id=='".concat(t,"'")).getTemp(),n=l.collection("uni-id-users").field("_id,username,nickname,avatar_file").getTemp();l.collection(i,n).get({getOne:!0}).then((function(t){console.log("xiangqing-------",t.result.data),e.article=t.result.data,e.editorCtx&&e.editorCtx.setContents({html:e.article.content})}))},editorReady:function(){var t=this;uni.createSelectorQuery().select("#editor").context((function(e){t.editorCtx=e.context})).exec()},editorFocus:function(){this.toolsShow=!0},statuschange:function(t){this.checkStatus("header",t.detail,"headClassToggle"),this.checkStatus("bold",t.detail,"boldClassToggle"),this.checkStatus("italic",t.detail,"italicClassToggle")},onDevider:function(){this.devideClassToggle=!this.devideClassToggle,this.editorCtx.insertDivider()},onHead:function(){this.headClassToggle=!this.headClassToggle,this.editorCtx.format("header",!!this.headClassToggle&&"H1")},onBold:function(){this.boldClassToggle=!this.boldClassToggle,this.editorCtx.format("bold")},onItalic:function(){this.italicClassToggle=!this.italicClassToggle,this.editorCtx.format("italic")},onOk:function(){this.toolsShow=!1},checkStatus:function(t,e,i){e.hasOwnProperty(t)?this[i]=!0:this[i]=!1},insertImage:function(){var e=this;uni.chooseImage({success:function(i){uni.showLoading({title:"加载中……",mask:!0}),i.tempFiles.map(function(){var i=(0,r.default)((0,o.default)().mark((function i(n){var a;return(0,o.default)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,t.uploadFile({filePath:n.path,cloudPath:n.name});case 2:a=i.sent,e.editorCtx.insertImage({src:a.fileID});case 4:case"end":return i.stop()}}),i)})));return function(t){return i.apply(this,arguments)}}()),uni.hideLoading()}})},onSubmit:function(){var t=this;this.editorCtx.getContents({success:function(e){var i={};i.title=t.article.title,i.content=e.html,i.desc=e.text.slice(0,50),i.pic_urls=(0,s.extractImagePaths)(e.html),console.log(i),uni.showLoading({title:"发布中..."}),t.publishArticle(i)}})},publishArticle:function(t){l.collection("quanzi-article").doc(this.arcID).update((0,a.default)({},t)).then((function(t){0==t.result.code&&(uni.hideLoading(),uni.showToast({title:"发布成功"}),setTimeout((function(){uni.switchTab({url:"/pages/index/index"})}),800))}))}}};e.default=c}).call(this,i("a9ff")["default"])},b1bf:function(t,e,i){"use strict";i.r(e);var n=i("9202"),a=i.n(n);for(var o in n)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(o);e["default"]=a.a},bcc0:function(t,e,i){"use strict";i.r(e);var n=i("1078"),a=i.n(n);for(var o in n)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(o);e["default"]=a.a},bd30:function(t,e,i){"use strict";i.r(e);var n=i("f08f"),a=i("b1bf");for(var o in a)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(o);i("efa4");var r=i("f0c5"),s=Object(r["a"])(a["default"],n["b"],n["c"],!1,null,"3278e702",null,!1,n["a"],void 0);e["default"]=s.exports},e2d5:function(t,e,i){"use strict";i("7a82");var n=i("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.formatDate=l,e.friendlyDate=function(t,e){var i=e.locale,n=void 0===i?"zh":i,a=e.threshold,o=void 0===a?[6e4,36e5]:a,r=e.format,c=void 0===r?"yyyy/MM/dd hh:mm:ss":r;if("-"===t)return t;if(!t&&0!==t)return"";var u,d,f={zh:{year:"年",month:"月",day:"天",hour:"小时",minute:"分钟",second:"秒",ago:"前",later:"后",justNow:"刚刚",soon:"马上",template:"{num}{unit}{suffix}"},en:{year:"year",month:"month",day:"day",hour:"hour",minute:"minute",second:"second",ago:"ago",later:"later",justNow:"just now",soon:"soon",template:"{num} {unit} {suffix}"}},h=f[n]||f.zh,v=s(t),g=v.getTime()-Date.now(),m=Math.abs(g);if(m<o[0])return g<0?h.justNow:h.soon;if(m>=o[1])return l(v,c);var p=h.later;g<0&&(p=h.ago,g=-g);var y=Math.floor(g/1e3),b=Math.floor(y/60),w=Math.floor(b/60),x=Math.floor(w/24),C=Math.floor(x/30),k=Math.floor(C/12);switch(!0){case k>0:u=k,d=h.year;break;case C>0:u=C,d=h.month;break;case x>0:u=x,d=h.day;break;case w>0:u=w,d=h.hour;break;case b>0:u=b,d=h.minute;break;default:u=y,d=h.second;break}"en"===n&&(1===u?u="a":d+="s");return h.template.replace(/{\s*num\s*}/g,u+"").replace(/{\s*unit\s*}/g,d).replace(/{\s*suffix\s*}/g,p)};var a=n(i("53ca"));function o(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;t+="";while(t.length<e)t="0"+t;return t.slice(-e)}i("fb6a"),i("c975"),i("ac1f"),i("5319");var r={yyyy:function(t){return o(t.year,4)},yy:function(t){return o(t.year)},MM:function(t){return o(t.month)},M:function(t){return t.month},dd:function(t){return o(t.day)},d:function(t){return t.day},hh:function(t){return o(t.hour)},h:function(t){return t.hour},mm:function(t){return o(t.minute)},m:function(t){return t.minute},ss:function(t){return o(t.second)},s:function(t){return t.second},SSS:function(t){return o(t.millisecond,3)},S:function(t){return t.millisecond}};function s(t){if(t instanceof Date)return t;switch((0,a.default)(t)){case"string":return t.indexOf("T")>-1?new Date(t):new Date(t.replace(/-/g,"/"));default:return new Date(t)}}function l(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"yyyy/MM/dd hh:mm:ss";if(!t&&0!==t)return"";t=s(t);var i={year:t.getFullYear(),month:t.getMonth()+1,day:t.getDate(),hour:t.getHours(),minute:t.getMinutes(),second:t.getSeconds(),millisecond:t.getMilliseconds()},n=/yyyy|yy|MM|M|dd|d|hh|h|mm|m|ss|s|SSS|SS|S/,a=!0,o=e;while(a)a=!1,o=o.replace(n,(function(t){return a=!0,r[t](i)}));return o}},efa4:function(t,e,i){"use strict";var n=i("3ea9"),a=i.n(n);a.a},f08f:function(t,e,i){"use strict";i.d(e,"b",(function(){return a})),i.d(e,"c",(function(){return o})),i.d(e,"a",(function(){return n}));var n={uniDateformat:i("453e").default,uButton:i("6258").default},a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"edit"},[i("v-uni-view",{staticClass:"title"},[i("v-uni-input",{attrs:{type:"text",placeholder:"请输入一个完整的标题","placeholder-class":"placeholder-class"},model:{value:t.article.title,callback:function(e){t.$set(t.article,"title",e)},expression:"article.title"}})],1),i("v-uni-view",{staticClass:"userinfo"},[i("v-uni-view",{staticClass:"left"},[i("v-uni-image",{attrs:{src:t.article.user_id[0].avatar_file?t.article.user_id[0].avatar_file.url:"../../static/imgs/avatar_default.png",mode:"aspectFill"}})],1),i("v-uni-view",{staticClass:"right"},[i("v-uni-view",{staticClass:"nickname"},[t._v(t._s(t.article.user_id[0].nickname||t.article.user_id[0].username))]),i("v-uni-view",{staticClass:"meta"},[i("v-uni-view",{staticClass:"publish-time"},[i("uni-dateformat",{attrs:{date:t.article.publish_date,threshold:[6e4,2592e6]}})],1),i("v-uni-text",{staticClass:"location"},[t._v("发布于"+t._s(t.article.province))])],1)],1)],1),i("v-uni-view",{staticClass:"content"},[i("v-uni-editor",{attrs:{id:"editor","show-img-size":!0,"show-img-toolbar":!0,"show-img-resize":!0,placeholder:"写点什么吧~~~"},on:{ready:function(e){arguments[0]=e=t.$handleEvent(e),t.editorReady.apply(void 0,arguments)},focus:function(e){arguments[0]=e=t.$handleEvent(e),t.editorFocus.apply(void 0,arguments)},statuschange:function(e){arguments[0]=e=t.$handleEvent(e),t.statuschange.apply(void 0,arguments)}}})],1),i("v-uni-view",{staticClass:"button-box"},[i("u-button",{attrs:{type:"primary",text:"确认发布",disabled:!t.article.title.length},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.onSubmit.apply(void 0,arguments)}}})],1),i("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:t.toolsShow,expression:"toolsShow"}],staticClass:"tools"},[i("v-uni-view",{staticClass:"tool",class:{active:t.headClassToggle},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.onHead.apply(void 0,arguments)}}},[i("v-uni-text",{staticClass:"iconfont icon-H-",staticStyle:{"font-size":"48rpx"}})],1),i("v-uni-view",{staticClass:"tool",class:{active:t.boldClassToggle},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.onBold.apply(void 0,arguments)}}},[i("v-uni-text",{staticClass:"iconfont icon-editor-bold"})],1),i("v-uni-view",{staticClass:"tool",class:{active:t.italicClassToggle},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.onItalic.apply(void 0,arguments)}}},[i("v-uni-text",{staticClass:"iconfont icon-editor-italic"})],1),i("v-uni-view",{staticClass:"tool",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.onDevider.apply(void 0,arguments)}}},[i("v-uni-text",{staticClass:"iconfont icon-line"})],1),i("v-uni-view",{staticClass:"tool",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.insertImage.apply(void 0,arguments)}}},[i("v-uni-text",{staticClass:"iconfont icon-image"})],1),i("v-uni-view",{staticClass:"tool",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.onOk.apply(void 0,arguments)}}},[i("v-uni-text",{staticClass:"iconfont icon-ok"})],1)],1)],1)},o=[]}}]);